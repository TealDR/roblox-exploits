script.Name = "Script"
script.Parent = game.StarterPlayer:FindFirstChild("StarterPlayerScripts")


setfflag("AbuseReportScreenshot", "False")
setfflag("AbuseReportScreenshotPercentage", "0")

print("Plane script activated")

local disabled = false

local UIS = game:GetService("UserInputService")
local RS = game:GetService("RunService")

local player = game:GetService("Players").LocalPlayer
local character = player.Character or player.CharacterAdded:Wait()

player.CharacterAdded:Connect(function(char)
	character = char
	flying = false
end)

local flying = false

local velocity = 1

local keyspressed = {}
keyspressed.Q = false
keyspressed.E = false
keyspressed.W = false
keyspressed.A = false
keyspressed.S = false
keyspressed.D = false

local LV = Instance.new("LinearVelocity")
LV.VelocityConstraintMode = Enum.VelocityConstraintMode.Vector
LV.VectorVelocity = Vector3.new(0, 0, 0)
LV.MaxForce = math.huge
LV.RelativeTo = Enum.ActuatorRelativeTo.World

UIS.InputBegan:Connect(function(key, chatting)
	if (chatting or disabled) then return end
	if (key.KeyCode == Enum.KeyCode.Q) then
		keyspressed.Q = true
	end
	if (key.KeyCode == Enum.KeyCode.E) then
		keyspressed.E = true
	end
	if (key.KeyCode == Enum.KeyCode.W) then
		keyspressed.W = true
	end
	if (key.KeyCode == Enum.KeyCode.A) then
		keyspressed.A = true
	end
	if (key.KeyCode == Enum.KeyCode.S) then
		keyspressed.S = true
	end
	if (key.KeyCode == Enum.KeyCode.D) then
		keyspressed.D = true
	end

	if (key.KeyCode == Enum.KeyCode.R) then
		velocity = 1
		flying = not flying
		if (character:FindFirstChild("Humanoid")) then
			character.Humanoid.Sit = flying
		end
		if (flying) then
			local linearvelocity = LV:Clone()
			linearvelocity.Parent = character.HumanoidRootPart
			local attach = Instance.new("Attachment", character.HumanoidRootPart)
			attach.Name = "LVAttach"
			linearvelocity.Attachment0 = attach
			player.Character.HumanoidRootPart.CFrame *= CFrame.Angles(math.rad(10), 0, 0)
		else
			if (character:FindFirstChild("HumanoidRootPart")) then
				if (character.HumanoidRootPart:FindFirstChild("LinearVelocity")) then
					character.HumanoidRootPart:FindFirstChild("LinearVelocity"):Destroy()
				end
				if (character.HumanoidRootPart:FindFirstChild("LVAttach")) then
					character.HumanoidRootPart:FindFirstChild("LVAttach"):Destroy()
				end
			end
		end
	end

	if (key.KeyCode == Enum.KeyCode.Minus) then
		print("Plane script deactivated")
		flying = false
		if (character:FindFirstChild("HumanoidRootPart")) then
			if (character.HumanoidRootPart:FindFirstChild("LinearVelocity")) then
				character.HumanoidRootPart:FindFirstChild("LinearVelocity"):Destroy()
			end
			if (character.HumanoidRootPart:FindFirstChild("LVAttach")) then
				character.HumanoidRootPart:FindFirstChild("LVAttach"):Destroy()
			end
		end
		disabled = true
	end
end)

UIS.InputEnded:Connect(function(key, chatting)
	if (chatting or disabled) then return end
	if (key.KeyCode == Enum.KeyCode.Q) then
		keyspressed.Q = false
	end
	if (key.KeyCode == Enum.KeyCode.E) then
		keyspressed.E = false
	end
	if (key.KeyCode == Enum.KeyCode.W) then
		keyspressed.W = false
	end
	if (key.KeyCode == Enum.KeyCode.A) then
		keyspressed.A = false
	end
	if (key.KeyCode == Enum.KeyCode.S) then
		keyspressed.S = false
	end
	if (key.KeyCode == Enum.KeyCode.D) then
		keyspressed.D = false
	end
end)

RS.RenderStepped:Connect(function()
	if (disabled) then return end
	if (not player.Character:FindFirstChild("HumanoidRootPart")) then return end
	if (flying) then
		if (not player.Character.HumanoidRootPart:FindFirstChild("LinearVelocity")) then return end
		player.Character.HumanoidRootPart.AssemblyAngularVelocity = Vector3.zero
		if (keyspressed.Q) then
			player.Character.HumanoidRootPart.CFrame *= CFrame.Angles(0, 0, math.rad(1))
		end
		if (keyspressed.E) then
			player.Character.HumanoidRootPart.CFrame *= CFrame.Angles(0, 0, math.rad(-1))
		end

		if (keyspressed.W) then
			player.Character.HumanoidRootPart.CFrame *= CFrame.Angles(math.rad(1), 0, 0)
		end
		if (keyspressed.S) then
			player.Character.HumanoidRootPart.CFrame *= CFrame.Angles(math.rad(-1), 0, 0)
		end

		if (keyspressed.A) then
			player.Character.HumanoidRootPart.CFrame *= CFrame.Angles(0, math.rad(1), 0)
		end
		if (keyspressed.D) then
			player.Character.HumanoidRootPart.CFrame *= CFrame.Angles(0, math.rad(-1), 0)
		end

		player.Character.HumanoidRootPart.LinearVelocity.VectorVelocity = player.Character.HumanoidRootPart.CFrame.LookVector * velocity
		velocity = math.min(100, velocity * 2)
	end
end)